{% extends 'base.html' %}

{% block title %}
Articles
{% endblock %}

{% block body %}
{% if message %}
<div class="lyrics">
    <p>{{ message }}</p>
</div>
{% else %}
<div class="fixed-panel">
    <a href="{{ url_for('articles.create_article') }}" class="btn btn-primary">Add Article</a>
</div>
<div class="articles-list mt-4">
    {% for article in articles %}
    <a href="{{ url_for('articles.article_detail', article_id=article.id) }}" class="article-link">
        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title">{{ article.title }}</h5>
                <p class="card-text">{{ article.content[:250] }}{% if article.content|length > 250 %}...{% endif %}</p>
                {% if article.content|length > 250 %}
                <a href="{{ url_for('articles.article_detail', article_id=article.id) }}" class="readmore">Read More</a>
                {% endif %}
            </div>
            <div class="card-footer text-muted small">
                Posted by {{ article.author.username }} on {{ article.date_posted.strftime('%Y-%m-%d %H:%M') }} UTC

                {% if article.date_modified and article.date_modified != article.date_posted %}
                <br><small>Last updated: {{ article.date_modified.strftime('%Y-%m-%d %H:%M') }} UTC</small>
                {% endif %}
            </div>

        </div>
    </a>
    {% else %}
    <p>No articles found.</p>
    {% endfor %}
</div>
{% endif %}
{% endblock %}